<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.ssafy.tigetting.mapper.BookingSeatMapper">

    <insert id="save" useGeneratedKeys="true" keyProperty="bookingSeatId">
        INSERT INTO booking_seats (booking_id, seat_id, seat_price, created_at)
        VALUES (#{booking.bookingId}, #{seat.seatId}, #{seatPrice}, #{createdAt})
    </insert>

    <select id="findByBookingId" resultMap="BookingSeatResultMap">
        SELECT * FROM booking_seats WHERE booking_id = #{bookingId}
    </select>

    <delete id="deleteByBookingId">
        DELETE FROM booking_seats WHERE booking_id = #{bookingId}
    </delete>

    <resultMap id="BookingSeatResultMap" type="BookingSeat">
        <id property="bookingSeatId" column="booking_seat_id"/>
        <result property="seatPrice" column="seat_price"/>
        <result property="createdAt" column="created_at"/>
        <association property="booking" column="booking_id" select="com.ssafy.tigetting.mapper.BookingMapper.findById"/>
        <association property="seat" column="seat_id" select="com.ssafy.tigetting.mapper.ScheduleSeatMapper.findById"/>
    </resultMap>

</mapper>
